pipeline {
                agent any
                tools{
                           jdk  "JAVA_HOME"
	      maven "maven"
                           }
environment {
        APP_NAME = "hellohabeelmaven"
        RELEASE = "1.0.0"
        DOCKER_USER = "habeel143341"
        DOCKER_PASS = 'dockerhub'
        IMAGE_NAME = "${DOCKER_USER}" + "/" + "${APP_NAME}"
        IMAGE_TAG = "${RELEASE}-${BUILD_NUMBER}"
        JENKINS_API_TOKEN = credentials("JENKINS_API_TOKEN")

    }


              stages {
        
                             stage("cleanup workspace"){

                                         steps{
                                                     cleanWs()
                                                    }
                                       }

                               stage("Checkout from SCM"){
                                          steps {
                                                 git branch: '*/master', credentialsId: 'githttps', url: 'https://github.com/habeel143341/linuxhello.git'
                                                }

                                                         }  

                                 stage("Build & Push Docker Image") {
                                         steps {
                                          script {
                                            docker.withRegistry('',DOCKER_PASS) {
                                          docker_image = docker.build "${IMAGE_NAME}"
                                               }
                                  
                                               }
                                             }

                                             }       
                            }
            
        
    
          }
